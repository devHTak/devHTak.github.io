---
layout: post
title: React Lifecycle API
summary: React
author: devhtak
date: '2021-02-11 22:41:00 +0900'
category: Frontend
---

#### LefeCycle API

- Component가 나타날 때(mounting), 업데이트 될 때(updating), 사라질 때(unmounting)를 기준으로 작업이 필요할 때 사용한다.
- LifeCycle API
  - Mounting
    - 컴포넌트가 브라우저 상에 나타날 때
    - Render Phase
      - constructor
      - getDerivedStateFromProps
      - render
    - Pre-Commit Phase
    - Commit Phase
      - componentDidMount
  - Updating - New props, setState(), forceUpdate()
    - 컴포넌트의 props, state가 변경할 때
    - Render Phase
      - getDerivedStateFromProps (mounting에서 new props 까지)
      - shouldComponentUpdate (new props + setState() 까지)
      - render
    - Pre-Commit Phase
      - getSnapshotBeforeUpdate
    - Commit Phase
      - componentDidUpdate
  - Unmounting
    - 컴포넌트가 브라우저에서 사라질 때
    - Commit Phase
      - componentWillUnmount
      
- Phase
  - Render Phase: Pure and has no side effects, May be paused, aborted or restarted by React.
  - Pre-Commit Phase: Can read the DOM
  - Commit Phase: Can work with DOM, run side effects, schedule updates.
      
- 예제
  - 컴포넌트 초기 생성
    - 컴포넌트가 브라우저에 나타나기 전, 후에 호출하는 API가 들어 있다.
    
    - constructor
      - 컴포넌트 생성자 함수
      - 컴포넌트가 새로 만들어질 때마다 해당 함수가 호추로딘다.
      ```javascript
      constructor(props) {
          super(props);
      }
      ```
      
    - componentDidMount
      - 컴포넌트가 화면에 나타나게 됐을 때 호출된다.
      - DOM을 사용해야 하는 외부 라이브러리를 연동
      - 해당 컴포넌트에서 필요로 하는 데이터를 요청하기 위해 axios, fetch 등을 통해 ajax 요청
      - DOM의 속성을 읽거나 직접 변경하는 작업을 진행
      ```javascript
      componentDidMount() {
          console.log('componentDidMount');
      }
      ```
            
  - 컴포넌트 업데이트
    - 컴포넌트 업데이트는 props의 변화, 그리고 state의 변화에 따라 결정된다.
    
    - componentWillReceiveProps
      - Component가 새로운 props를 받게됐을 때 호출
      - state와 props에 따라 변해야 하는 로직을 작성한다.
      - 새로 받게될 props는 nextProps로 조회할 수 있으며, 이 때 this.props를 조회하면 업데이트 되기 전의 API이다.
      - 16.3부터 getDerivedStateFromProps()로 대체
      ```javascript
      componentWillReceiveProps(nextProps) {
          //this.props는 아직 바뀌지 않은 상태
      }
      ```
    
    - getDerivedStateFromProps
      - v16.3 이후에 만들어진 라이프사이클 API
      - setState를 하는 것이 아니라 리턴하는 형태
      - componentWillReceiveProps와 다르게 초기화 과정에서도 실행된다.
      ```javascript
      static getDerivedStateFromProps(nextProps, prevState) {
          // 여기서는 setState 를 하는 것이 아니라
          // 특정 props 가 바뀔 때 설정하고 설정하고 싶은 state 값을 리턴하는 형태로
          // 사용됩니다.
          /*
          if (nextProps.value !== prevState.value) {
            return { value: nextProps.value };
          }
          return null; // null 을 리턴하면 따로 업데이트 할 것은 없다라는 의미
          */
      }
      ```
      
      
      
      
      
 - 출처: https://react-anyone.vlpt.us/05.html     

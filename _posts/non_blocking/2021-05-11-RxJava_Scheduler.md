---
layout: post
title: RxJava, Scheduler
summary: RxJava
author: devhtak
date: '2021-05-11 21:41:00 +0900'
category: RxJava
---

#### 물리적인 쓰레드와 논리적인 쓰레드의 이해

- 물리적인 쓰레드는 하드웨어와 관련이 있고, 논리적인 쓰레드는 소프트웨어와 관련이 있다.

![image](https://user-images.githubusercontent.com/42403023/117760816-47bbe480-b261-11eb-8c1c-fa1ccb98bd02.png)

- 물리적 쓰레드
  - 물리적인 쓰레드를 이해하기 위해서는 CPU의 코어를 먼저 알아야 한다.
  - 코어는 물리적인 쓰레드는 물리적인 코어를 논리적으로 쪼객 논리적 코어다.
  - CPU의 명령어를 처리하는 반도체 유닛
  - 코어의 갯수가 많으면 명령어를 병렬로(parallel) 더 많이 더 빠르게 처리할 수 있다. 

- 논리적 쓰레드
  - 논리적인 쓰레드는 프로세스 내에서 실행되는 세부 작업의 단위이다. 
  - 프로세스는 컴퓨터에서 실행할 수 있는 실행 파일(프로그램)을 실행하면 생기는 인스턴스이다. 
  - 논리적인 쓰레드의 생성 개수는 이론적으로는 제한이 없지만 실제로는 물리적인 쓰레드의 가용 범위내에서 생성할 수 있다. 

#### 스케쥴러(Scheduler)

- RxJava에서의 스케쥴러는 RxJava 비동기 프로그래밍을 위한 쓰레드(Thread) 관리자이다.
- 즉, 스케쥴러를 이용해서 어떤 쓰레드에서 무엇을 처리할 지에 대해서 제어할 수 있다.
- 스케쥴러를 이용해서 데이터를 통지하는 쪽과 데이터를 처리하는 쪽 쓰레드를 별도로 지정해서 분리할 수 있다.
- RxJava의 스케쥴러를 통해 쓰레드를 위한 코드의 간결성 및 쓰레드 관리의 복잡함을 줄일 수 있다.
- RxJava에서 스케쥴러를 지정하기 위해서 subscribeOn( ), observeOn( ) 유틸리티 연산자를 사용한다.
- 생산자쪽의 데이터 흐름을 제어하기 위해서는 subscribeOn( ) 연산자를 사용한다.
- 소비자쪽에서 전달받은 데이터 처리를 제어하기 위해서는 observeOn( ) 연산자를 사용한다.
- subscribeOn( ), observeOn( ) 연산자는 각각 파라미터로 Scheduler를 지정해야 한다.

#### 스케줄러의 종류

- Schedulers.io()
  - I/O 처리 작업을 할 때 사용하는 스케쥴러
  - 네트워크 요청 처리, 각종 입/출력 작업, 데이터베이스 쿼리 등에 사용
  - 쓰레드 풀에서 쓰레드를 가져오거나 가져올 쓰레드가 없으면 새로운 쓰레드를 생성한다. 

- Schedulers.computation()
  - 논리적인 연산 처리 시, 사용하는 스케쥴러
  - CPU 코어의 물리적 쓰레드 수를 넘지 않는 범위에서 쓰레드를 생성한다.
  - 대기 시간 없이 빠르게 계산 작업을 수행하기 위해 사용한다.

- Schedulers.newThread()
  - 요청시마다 매번 새로운 쓰레드를 생성한다.
  - 매번 생성되면 쓰레드 비용도 많이 들고, 재사용도 되지 않는다.

- Schedulers.trampoline()
  - 현재 실행되고 있는 쓰레드에 큐(Queue)를 생성하여 처리할 작업들을 큐에 넣고 순서대로 처리한다.

- Schedulers.single()
  - 단일 쓰레드를 생성하여 처리 작업을 진행한다
  - 여러번 구독해도 공통으로 사용한다.

- Schedulers.from(executor)
  - Executor를 사용해서 생성한 쓰레드를 사용한다.
  - RxJava의 Scheduler와 Executor의 동작 방식이 다르므로 자주 사용되지 않음.

#### 출처

Kevin의 알기 쉬운 RxJava 2부
